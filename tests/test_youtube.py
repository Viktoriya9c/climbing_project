from pytube import YouTube
import os

# –¢–µ—Å—Ç–æ–≤–æ–µ –≤–∏–¥–µ–æ ‚Äî –∫–æ—Ä–æ—Ç–∫–æ–µ (16 —Å–µ–∫—É–Ω–¥), –ø—É–±–ª–∏—á–Ω–æ–µ
# –ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –º–æ–∂–µ—à—å –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ —Å YouTube
url = "https://www.youtube.com/live/K-H3aNqityk?si=O1cNXs6SIriRuVSm&t=1978"  # –∫–æ—Ä–æ—Ç–∫–æ–µ –≤–∏–¥–µ–æ —Å –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º

print("üîÑ –ù–∞—á–∏–Ω–∞—é –∑–∞–≥—Ä—É–∑–∫—É –≤–∏–¥–µ–æ...")

try:
    # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç YouTube
    yt = YouTube(url)
    
    # –í—ã–≤–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
    print(f"‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ: {yt.title}")
    print(f"‚úÖ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {yt.length} —Å–µ–∫—É–Ω–¥")
    print(f"‚úÖ –ê–≤—Ç–æ—Ä: {yt.author}")
    
    # –í—ã–±–∏—Ä–∞–µ–º –ø–æ—Ç–æ–∫ —Å —Å–∞–º—ã–º –Ω–∏–∑–∫–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º (–¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏)
    stream = yt.streams.filter(progressive=True, file_extension='mp4').order_by('resolution').first()
    
    if stream:
        print(f"‚úÖ –í—ã–±—Ä–∞–Ω–æ –∫–∞—á–µ—Å—Ç–≤–æ: {stream.resolution}")
        
        # –°–∫–∞—á–∏–≤–∞–µ–º –≤–∏–¥–µ–æ
        stream.download(output_path=".", filename="test_video.mp4")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ñ–∞–π–ª —Å–æ–∑–¥–∞–ª—Å—è
        if os.path.exists("test_video.mp4"):
            file_size = os.path.getsize("test_video.mp4") // 1024  # —Ä–∞–∑–º–µ—Ä –≤ –ö–ë
            print(f"‚úÖ –í–∏–¥–µ–æ —Å–∫–∞—á–∞–Ω–æ! –†–∞–∑–º–µ—Ä: {file_size} –ö–ë")
            print("‚úÖ –§–∞–π–ª: test_video.mp4")
        else:
            print("‚ùå –û—à–∏–±–∫–∞: —Ñ–∞–π–ª –Ω–µ —Å–æ–∑–¥–∞–ª—Å—è")
    else:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–æ—Ç–æ–∫ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è")
        
except Exception as e:
    print(f"‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {type(e).__name__}: {e}")